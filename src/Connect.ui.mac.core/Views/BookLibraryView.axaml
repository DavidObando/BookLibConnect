<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:core.audiamus.connect.ui.mac.ViewModels"
             x:Class="core.audiamus.connect.ui.mac.Views.BookLibraryView"
             x:DataType="vm:BookLibraryViewModel">

  <DockPanel>
    <!-- Toolbar -->
    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Spacing="8" Margin="8">
      <TextBox Watermark="Filter books..."
               Text="{Binding FilterText}"
               Width="250" />
      <Button Content="Select All" Command="{Binding SelectAllCommand}" />
      <Button Content="Deselect All" Command="{Binding DeselectAllCommand}" />
      <Border Width="1" Background="LightGray" Margin="4,2" />
      <Button Content="Download Selected"
              Command="{Binding DownloadSelectedCommand}"
              Classes="accent" />
      <TextBlock Text="{Binding SelectedCount, StringFormat='{}{0} selected'}"
                 VerticalAlignment="Center" Foreground="Gray" FontSize="12" />
    </StackPanel>

    <!-- Book list -->
    <DataGrid x:Name="booksGrid"
              ItemsSource="{Binding Books}"
              SelectedItem="{Binding SelectedBook}"
              AutoGenerateColumns="False"
              CanUserResizeColumns="True"
              CanUserSortColumns="True"
              GridLinesVisibility="Horizontal"
              Margin="8">
      <DataGrid.Columns>
        <DataGridCheckBoxColumn Header="&#x2713;"
                                Binding="{Binding IsSelected}"
                                Width="40" />
        <DataGridTextColumn Header="Title"
                            Binding="{Binding Title}"
                            IsReadOnly="True"
                            Width="*" />
        <DataGridTextColumn Header="Author"
                            Binding="{Binding Author}"
                            IsReadOnly="True"
                            Width="200" />
        <DataGridTextColumn Header="Narrator"
                            Binding="{Binding Narrator}"
                            IsReadOnly="True"
                            Width="150" />
        <DataGridTemplateColumn Header="Duration"
                                SortMemberPath="RunTimeLengthSeconds"
                                Width="80">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <TextBlock Text="{Binding Duration}"
                         VerticalAlignment="Center"
                         Margin="4,0" />
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
        <DataGridTextColumn Header="Purchased"
                            Binding="{Binding PurchaseDate, StringFormat='{}{0:yyyy-MM-dd}'}"
                            IsReadOnly="True"
                            Width="100" />
        <DataGridTextColumn Header="State"
                            Binding="{Binding ConversionState}"
                            IsReadOnly="True"
                            Width="100" />
      </DataGrid.Columns>
    </DataGrid>
  </DockPanel>

</UserControl>
